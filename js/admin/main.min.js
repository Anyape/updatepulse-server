jQuery(document).ready(function(a){function e(a){var e=(new DOMParser).parseFromString(a,"text/html");return e.documentElement.textContent}if(-1!==location.href.indexOf("action=")){var t=window.location.href.split("?");t[1]=t[1].replace("action=","action_done="),history.pushState(null,"",t.join("?"))}a('input[type="password"].secret').on("focus",function(){a(this).attr("type","text")}),a('input[type="password"].secret').on("blur",function(){a(this).attr("type","password")}),a(".wppus-wrap .wp-list-table .delete a").on("click",function(a){var e=window.confirm(Wppus_l10n.deleteRecord);e||a.preventDefault()}),a(".wppus-delete-all-packages").on("click",function(a){var e=window.confirm(Wppus_l10n.deletePackagesConfirm);e||a.preventDefault()}),a(".ajax-trigger").on("click",function(t){t.preventDefault();var n=a(this),i=n.data("type"),p={type:i,nonce:a("#wppus_plugin_options_handler_nonce").val(),action:"wppus_"+n.data("action"),data:n.data("selector")?a(n.data("selector")).get().reduce(function(a,e){return a[e.id]="checkbox"===e.type||"radio"===e.type?e.checked:e.value,a},{}):{}};n.attr("disabled","disabled"),a.ajax({url:Wppus.ajax_url,data:p,type:"POST",success:function(t){if(t.success){if(t.data){i="";a.each(t.data,function(a,t){"btnVal"!==a&&(i+=e(t)+"\n")}),i.length&&window.alert(i)}}else{var i="";a.each(t.data,function(a,t){i+=e(t.message)+"\n"}),window.alert(i)}n.removeAttr("disabled"),t.data&&t.data.btnVal&&n.val(t.data.btnVal)},error:function(a,e){Wppus.debug&&console.log(e)}})});var n=!1;a("#wppus_prime_package_slug").on("keyup",function(){var e=a(this);0<e.val().length?a("#wppus_prime_package_trigger").removeAttr("disabled"):n||a("#wppus_prime_package_trigger").attr("disabled","disabled")}),a("#wppus_prime_package_trigger").on("click",function(e){e.preventDefault();var t=a(this),i={slug:a("#wppus_prime_package_slug").val(),nonce:a("#wppus_plugin_options_handler_nonce").val(),action:"wppus_prime_package_from_remote"};t.attr("disabled","disabled"),t.next().css("visibility","visible"),n=!0,a.ajax({url:Wppus.ajax_url,data:i,type:"POST",success:function(e){if(e.success)window.location.reload(!0);else{var i="";a.each(e.data,function(a,e){i+=e.message+"\n"}),n=!1,t.removeAttr("disabled"),t.next().css("visibility","hidden"),window.alert(i)}},error:function(a,e){Wppus.debug&&console.log(e),n=!1,t.removeAttr("disabled"),t.next().css("visibility","hidden")}})}),a("#wppus_manual_package_upload").on("change",function(){var e=a(this);0<e.prop("files").length?(a("#wppus_manual_package_upload_filename").val(e.prop("files")[0].name),a("#wppus_manual_package_upload_trigger").removeAttr("disabled")):(a("#wppus_manual_package_upload_filename").val(""),a("#wppus_manual_package_upload_trigger").attr("disabled","disabled"))}),a("#wppus_manual_package_upload_dropzone").on("drag dragstart dragend dragover dragenter dragleave drop",function(a){a.preventDefault(),a.stopPropagation()}).on("drop",function(e){var t=a("#wppus_manual_package_upload");t.prop("files",e.originalEvent.dataTransfer.files),t.trigger("change")}),a(".manual-package-upload-trigger").on("click",function(e){e.preventDefault();var t=a(this),n=new FormData,i=!0,p=a("#wppus_manual_package_upload").prop("files")[0],o=/^([a-zA-Z0-9\-\_]*)\.zip$/gm,l=["multipart/x-zip","application/zip","application/zip-compressed","application/x-zip-compressed"];t.attr("disabled","disabled"),t.next().css("visibility","visible"),void 0!==p&&void 0!==p.type&&void 0!==p.size&&void 0!==p.name?(-1===a.inArray(p.type,l)&&(window.alert(Wppus_l10n.invalidFileFormat),i=!1),0===p.size&&(window.alert(Wppus_l10n.invalidFileSize),i=!1),o.test(p.name)||(window.alert(Wppus_l10n.invalidFileName),i=!1)):(window.alert(Wppus_l10n.invalidFile),i=!1),i?(n.append("action","wppus_manual_package_upload"),n.append("package",p),n.append("nonce",a("#wppus_plugin_options_handler_nonce").val()),a.ajax({url:Wppus.ajax_url,data:n,type:"POST",cache:!1,contentType:!1,processData:!1,success:function(e){if(e.success)window.location.reload(!0);else{var n="";a.each(e.data,function(a,e){n+=e.message+"\n"}),t.removeAttr("disabled"),window.alert(n)}},error:function(a,e){Wppus.debug&&console.log(e)}})):(t.next().css("visibility","hidden"),t.removeAttr("disabled"))})});