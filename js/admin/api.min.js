jQuery(document).ready(function(e){function t(e){var t=new Uint8Array(e),n="";window.crypto.getRandomValues(t);for(var i=0;i<t.length;i++)n+=t[i].toString(e).padStart(2,"0");return n}e(".webhook-multiple").each(function(t,n){function i(){var e=s.get(0).value.trim(),t=""!==e&&!Object.values(o).some(function(t){return t===e}),n=/^(https?:\/\/)?([\w-]+(\.[\w-]+)+\/?)|localhost(:\d+)?(\/[\w-]+)*\/?(\?\S*)?$/;t=t&&n.test(e)&&1<=c.val().length,r.disabled=!t}function a(){u.innerHTML="",Object.keys(o).forEach(function(e){var t=document.createElement("div"),n=document.createElement("span"),i=document.createElement("span"),s=document.createElement("span"),c=document.createElement("span"),l=document.createElement("button");t.className="item",i.textContent=e,i.title=e,i.classList="url",n.classList="url-container",s.textContent=o[e].secret,s.classList="secret",c.textContent="("+o[e].events.join(", ")+")",c.classList="events",l.type="button",l.innerHTML='<span class="wppus-remove-icon" aria-hidden="true"></span>',l.onclick=function(){confirm(Wppus_l10n.deleteApiWebhookConfirm)&&(delete o[e],a())},n.appendChild(i),n.appendChild(c),t.appendChild(n),t.appendChild(s),t.appendChild(l),u.appendChild(t)}),0===Object.keys(o).length?u.classList.add("empty"):u.classList.remove("empty")}n=e(n);var o=JSON.parse(n.find(".webhook-values").val()),s=n.find(".new-webhook-item-url"),c=n.find(".new-webhook-item-secret"),l=n.find('input[data-webhook-event="all"]'),d=n.find('input[data-webhook-event="package"]'),p=n.find('input[data-webhook-event="license"]'),r=n.find(".webhook-add").get(0),u=n.find(".webhook-items").get(0);0===o.length&&(o={}),r.onclick=function(){r.disabled="disabled",o[s.val()]={secret:c.val(),events:[]},d&&o[s.val()].events.push(d.data("webhook-event")),p&&o[s.val()].events.push(p.data("webhook-event")),console.log(o),s.val(""),c.val(""),l.prop("checked",!0),l.trigger("change"),a()},s.on("input",i),c.on("input",i),n.find('.webhook-event-types input[type="checkbox"]').on("change",function(){l.prop("checked")?(d.prop("checked",!0),d.prop("disabled",!0),p.prop("checked",!0),p.prop("disabled",!0)):(d.prop("disabled",!1),p.prop("disabled",!1))}),l.prop("checked",!0),l.trigger("change"),a(),e('input[type="submit"]').on("click",function(t){t.preventDefault(),n.find(".webhook-values").val(JSON.stringify(o)),e(this).closest("form").submit()})}),e(".api-keys-multiple").each(function(n,i){function a(){l.innerHTML="",Object.keys(o).forEach(function(e){var t=document.createElement("div"),n=document.createElement("span"),i=document.createElement("span"),s=document.createElement("button");t.className="item",n.textContent=o[e],n.classList="name",i.textContent=e,i.classList="key",s.type="button",s.innerHTML='<span class="wppus-remove-icon" aria-hidden="true"></span>',s.onclick=function(){confirm(Wppus_l10n.deleteApiKeyConfirm)&&(delete o[e],a())},t.appendChild(n),t.appendChild(i),t.appendChild(s),l.appendChild(t)}),0===Object.keys(o).length?l.classList.add("empty"):l.classList.remove("empty")}i=e(i);var o=JSON.parse(i.find(".api-key-values").val()),s=i.find(".new-api-key-item-name"),c=i.find(".api-keys-add").get(0),l=i.find(".api-keys-items").get(0);0===o.length&&(o={}),c.onclick=function(){c.disabled="disabled",o[t(16)]=s.val(),s.val(""),a()},s.on("input",function(){var t=e(this).get(0).value.trim(),n=""!==t&&!Object.values(o).some(function(e){return e===t});c.disabled=!n}),a(),e('input[type="submit"]').on("click",function(t){t.preventDefault(),i.find(".api-key-values").val(JSON.stringify(o)),e(this).closest("form").submit()})})});